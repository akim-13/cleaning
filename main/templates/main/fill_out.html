<!DOCTYPE html>
<html>

<head>
    {% load static %}
    <link rel="stylesheet" href="{% static 'main/css/fill_out.css' %}">
    <title>Форма качества уборки</title>
</head>

<body>

<h1>Форма качества уборки</h1>

<form id="markForm" action="{% url 'fill_out' location=location %}" method="post">
{% csrf_token %}
<table id="tableID">
    <tr>
        <th>Время</th>
        <th>Зона</th>
        <th>Оценка</th>
        <th>Утверждена</th>
        <th>Замечания</th>
        <th>Коментарии к замечаниям</th>
    </tr>

    <td class="time-cell" rowspan="3">9:00 - 10:00</td>
    {% for row in rows %}
    <tr>
        <td>{{ row.zone }}</td>
        <td>{{ row.mark }}</td>
        <td>{{ row.approval }}</td>
        <td>{{ row.customer_comment }}</td>
        <td>{{ row.contractor_comment }}</td>
    </tr>
    {% endfor %}

    <td id="last-time-cell" class="time-cell" time-period-ended="false" rowspan="4">10:00</td>
    <tr>
        <td>tst</td>
        <td>adfs</td>
        <td>adfa</td>
        <td>412</td>
        <td>fads</td>
    </tr>
    <tr>
        <td>tst</td>
        <td>adfs</td>
        <td>adfa</td>
        <td>412</td>
        <td>fads</td>
    </tr>
    <tr>
        <td>Или тут?</td>
        <td>adfs</td>
        <td>adfa</td>
        <td>412</td>
        <td>fads</td>
    </tr>
    
    <tr>
        <td id="empty-cell" class="empty-cell"></td>
        <td><button type="button" onclick="appendRow()">+</button></td>
    </tr>
    
</table>
</form>
<button type="button" onclick="submitForms()">Готово</button>
<br>

<input id="chat-message-input" type="text" size="100"><br>
<input id="chat-message-submit" type="button" value="Send">


<!-- Will redner as a <script> tag with the location name as the text content and id="location-name". -->
{{ location | json_script:"location-name" }}

<script src="{% static 'main/js/fill_out.js' %}"></script>
<script>
     document.querySelector('#chat-message-input').focus();
        document.querySelector('#chat-message-input').onkeyup = function(e) {
            if (e.key === 'Enter') {  // enter, return
                document.querySelector('#chat-message-submit').click();
            }
        };

        document.querySelector('#chat-message-submit').onclick = function(e) {
            const messageInputDom = document.querySelector('#chat-message-input');
            const message = messageInputDom.value;
            locationSocket.send(JSON.stringify({
                'message': message
            }));
            messageInputDom.value = '';
        };
</script>

</body>
</html>